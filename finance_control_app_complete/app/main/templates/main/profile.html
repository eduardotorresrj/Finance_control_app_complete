{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="text-white"><i class="bi bi-person-circle"></i> Meu Perfil</h2>
</div>

<div class="row">
  <div class="col-md-4 mb-4">
    <div class="card fade-in">
      <div class="card-body text-center">
        <div class="mb-3">
          <i class="bi bi-person-circle" style="font-size: 5rem; color: var(--primary-color);"></i>
        </div>
        <h4>{{ user.name or 'UsuÃ¡rio' }}</h4>
        <p class="text-muted">{{ user.email }}</p>
        <hr>
        <p class="text-muted mb-0">
          <small><i class="bi bi-calendar"></i> Membro desde {{ user.created_at.strftime('%d/%m/%Y') }}</small>
        </p>
      </div>
    </div>
  </div>
  
  <div class="col-md-8 mb-4">
    <div class="card fade-in">
      <div class="card-header">
        <h4 class="mb-0"><i class="bi bi-graph-up"></i> EstatÃ­sticas Gerais</h4>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6 mb-3">
            <div class="stat-card info">
              <div class="stat-label">ðŸ“Š Total de TransaÃ§Ãµes</div>
              <div class="stat-value">{{ total_transactions }}</div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="stat-card success">
              <div class="stat-label">ðŸ’° Receitas (30 dias)</div>
              <div class="stat-value">R$ {{ "{:,.2f}".format(total_income_30d) }}</div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="stat-card danger">
              <div class="stat-label">ðŸ’¸ Despesas (30 dias)</div>
              <div class="stat-value">R$ {{ "{:,.2f}".format(total_expense_30d) }}</div>
            </div>
          </div>
          <div class="col-md-6 mb-3">
            <div class="stat-card {% if (total_income_30d - total_expense_30d) >= 0 %}info{% else %}warning{% endif %}">
              <div class="stat-label">ðŸ’µ Saldo (30 dias)</div>
              <div class="stat-value">R$ {{ "{:,.2f}".format(total_income_30d - total_expense_30d) }}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="card fade-in">
  <div class="card-header">
    <h4 class="mb-0"><i class="bi bi-tags"></i> Categorias Mais Usadas</h4>
  </div>
  <div class="card-body">
    {% if top_categories %}
    <div class="list-group">
      {% for category, count in top_categories %}
      <div class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <i class="bi bi-tag-fill text-primary"></i>
          <strong>{{ category }}</strong>
        </div>
        <span class="badge bg-primary rounded-pill">{{ count }} transaÃ§Ãµes</span>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z" />
      </svg>
      <h5>Nenhuma categoria ainda</h5>
      <p class="text-muted">Comece a adicionar transaÃ§Ãµes para ver suas categorias mais usadas.</p>
    </div>
    {% endif %}
  </div>
</div>

<div class="card fade-in mt-4">
  <div class="card-header">
    <h4 class="mb-0"><i class="bi bi-gear"></i> AÃ§Ãµes RÃ¡pidas</h4>
  </div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-3 mb-2">
        <a href="/dashboard" class="btn btn-outline-primary w-100">
          <i class="bi bi-speedometer2"></i><br>
          <small>Dashboard</small>
        </a>
      </div>
      <div class="col-md-3 mb-2">
        <a href="/transaction/add" class="btn btn-outline-success w-100">
          <i class="bi bi-plus-circle"></i><br>
          <small>Nova TransaÃ§Ã£o</small>
        </a>
      </div>
      <div class="col-md-3 mb-2">
        <a href="/reports" class="btn btn-outline-info w-100">
          <i class="bi bi-file-earmark-text"></i><br>
          <small>RelatÃ³rios</small>
        </a>
      </div>
      <div class="col-md-3 mb-2">
        <a href="/auth/logout" class="btn btn-outline-danger w-100">
          <i class="bi bi-box-arrow-right"></i><br>
          <small>Sair</small>
        </a>
      </div>
    </div>
  </div>
</div>
{% endblock %}

